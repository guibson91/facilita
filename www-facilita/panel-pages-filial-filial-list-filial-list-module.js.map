{"version":3,"sources":["webpack:///./src/app/panel/pages/filial/filial-list/filial-list.module.ts","webpack:///./src/app/panel/pages/filial/filial-list/filial-list.page.html","webpack:///./src/app/panel/pages/filial/filial-list/filial-list.page.scss","webpack:///./src/app/panel/pages/filial/filial-list/filial-list.page.ts"],"names":[],"mappings":"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","file":"panel-pages-filial-filial-list-filial-list-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { NgPipesModule } from 'ngx-pipes';\r\n\r\nimport { FilialListPage } from './filial-list.page';\r\nimport { PanelComponentsModule } from '../../../components/panel-components.module';\r\nimport { GlobalComponentsModule } from '../../../../components/global-components.module';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: FilialListPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    IonicModule,\r\n    PanelComponentsModule,\r\n    GlobalComponentsModule,\r\n    NgPipesModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  declarations: [FilialListPage]\r\n})\r\nexport class FilialListPageModule { }\r\n","module.exports = \"<ion-header no-border>\\r\\n  <nano-navbar title=\\\"Estabelecimentos\\\" icon=\\\"menus-icon-shop\\\" [helpPage]=\\\"4\\\">\\r\\n  </nano-navbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content padding>\\r\\n\\r\\n  <ion-card class=\\\"content-card\\\">\\r\\n    <ion-searchbar [(ngModel)]=\\\"searchString\\\" placeholder=\\\"Pesquisar\\\" (ionChange)=\\\"detect()\\\">\\r\\n    </ion-searchbar>\\r\\n\\r\\n    <nano-loading [loading]=\\\"loading\\\">\\r\\n      <ion-list>\\r\\n        <div class=\\\"filial-div\\\" *ngFor=\\\"let filial of filials | filterBy:['name', 'location.street', 'location.district', 'location.state', 'location.country', 'location.city']:searchString\\\">\\r\\n          <div padding text-wrap>\\r\\n\\r\\n            <nano-thumb large=\\\"true\\\" [src]=\\\"filial.image\\\"></nano-thumb>\\r\\n\\r\\n            <div class=\\\"content-filial\\\" text-wrap padding-start>\\r\\n              <h1>{{filial.name}}</h1>\\r\\n              <p>{{filial.location?.street}}, {{filial.location?.number}} - {{filial.location?.district}},\\r\\n                {{filial.location?.city}},\\r\\n                {{filial.location?.state}}\\r\\n              </p>\\r\\n            </div>\\r\\n\\r\\n          </div>\\r\\n          <div class=\\\"flex-content\\\" padding>\\r\\n            <div class=\\\"buttons\\\">\\r\\n              <ion-button class=\\\"negative-margin\\\" (click)=\\\"openStock(filial)\\\" fill=\\\"clear\\\" color=\\\"proceed\\\" *ngIf=\\\"company?.delivery\\\">\\r\\n                <div class=\\\"menus-icon menus-icon-menu\\\"></div> Estoque\\r\\n              </ion-button>\\r\\n\\r\\n              <ion-button class=\\\"negative-margin\\\" (click)=\\\"openStockPromotion(filial)\\\" fill=\\\"clear\\\" color=\\\"proceed\\\" *ngIf=\\\"company?.promotion\\\">\\r\\n                <div class=\\\"menus-icon menus-icon-menu\\\"></div> Estoque de promoções\\r\\n              </ion-button>\\r\\n\\r\\n              <ion-button class=\\\"negative-margin\\\" (click)=\\\"openInvoice(filial)\\\" fill=\\\"clear\\\" color=\\\"proceed\\\">\\r\\n                <div class=\\\"menus-icon menus-icon-credit-card\\\"></div> Fatura\\r\\n              </ion-button>\\r\\n\\r\\n              <ion-button class=\\\"negative-margin\\\" (click)=\\\"openStatistics(filial)\\\" fill=\\\"clear\\\" color=\\\"proceed\\\">\\r\\n                <div class=\\\"menus-icon menus-icon-ecommerce-12\\\"></div><span></span> Vendas\\r\\n              </ion-button>\\r\\n\\r\\n              <ion-button fill=\\\"clear\\\" (click)=\\\"edit(filial)\\\" color=\\\"proceed\\\">\\r\\n                <ion-icon name=\\\"md-create\\\"></ion-icon> Editar\\r\\n              </ion-button>\\r\\n\\r\\n            </div>\\r\\n            <ion-item class=\\\"active\\\" *ngIf=\\\"isTEAM\\\">\\r\\n              <ion-label style=\\\"display: block\\\">Ativo</ion-label>\\r\\n              <ion-toggle [(ngModel)]=\\\"filial.active\\\" (ionChange)=\\\"changeActiveStatus(filial)\\\"></ion-toggle>\\r\\n            </ion-item>\\r\\n          </div>\\r\\n          <card-filial-open [filial]=\\\"filial\\\" [inside]=\\\"true\\\"></card-filial-open>\\r\\n        </div>\\r\\n\\r\\n        <ion-item text-center padding *ngIf=\\\"!existsFilials\\\">\\r\\n          <p ion-text>Você ainda não possui filial</p>\\r\\n        </ion-item>\\r\\n      </ion-list>\\r\\n    </nano-loading>\\r\\n  </ion-card>\\r\\n\\r\\n  <ion-fab vertical=\\\"bottom\\\" horizontal=\\\"end\\\" slot=\\\"fixed\\\" *ngIf=\\\"company\\\">\\r\\n    <ion-fab-button color=\\\"primary\\\" (click)=\\\"add()\\\">\\r\\n      <ion-icon name=\\\"add\\\"></ion-icon>\\r\\n    </ion-fab-button>\\r\\n  </ion-fab>\\r\\n\\r\\n</ion-content>\"","module.exports = \"ion-item.active {\\n  margin-left: 10px; }\\n  ion-item.active ion-label {\\n    font-size: 1.2em;\\n    font-weight: bold;\\n    color: var(--ion-color-primary); }\\n  .active ion-label.gone {\\n  display: none !important; }\\n  .filial-div {\\n  border-top: solid 1px #ddd !important; }\\n  nano-thumb {\\n  display: inline-block; }\\n  .content-filial {\\n  display: inline-block;\\n  margin-left: 8px; }\\n  .flex-content {\\n  display: flex;\\n  justify-content: space-between; }\\n  ion-item button.negative-margin {\\n  margin-left: -6px !important; }\\n  ion-item button span {\\n  color: var(--ion-color-proceed) !important;\\n  font-size: 1.1em !important; }\\n  ion-item .text-md-filial {\\n  color: var(--ion-color-proceed) !important; }\\n  ion-item .buttons {\\n  display: flex;\\n  align-items: center; }\\n\"","import { Component, OnInit, ChangeDetectorRef, OnDestroy } from '@angular/core';\r\nimport { Observable, of, Subscription } from 'rxjs';\r\nimport { Filial } from '../../../../../models/filial';\r\nimport { Company } from '../../../../../models/company';\r\nimport { NavController, MenuController, LoadingController } from '@ionic/angular';\r\nimport { AuthenticationService } from '../../../../services/authentication.service';\r\nimport { SharedService } from '../../../../services/shared.service';\r\nimport { SystemService } from '../../../../services/system.service';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { switchMap, first, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-filial-list',\r\n  templateUrl: './filial-list.page.html',\r\n  styleUrls: ['./filial-list.page.scss'],\r\n})\r\nexport class FilialListPage implements OnInit, OnDestroy {\r\n\r\n  /**\r\n   * Capta o que foi digitado pelo usuário no campo de pesquisa.\r\n   */\r\n  searchString: string = \"\";\r\n\r\n  /**\r\n   * Observable que contém a lista de filiais\r\n   */\r\n  filials: Filial[];\r\n\r\n  initSubscription: Subscription\r\n\r\n  /**\r\n   * Se está carregando os elementos da página.\r\n   */\r\n  loading: boolean = true;\r\n\r\n  /**\r\n   * Se não possui filiais.\r\n   * Se após baixar não vier filiais aí sim podemos garantir que não existem filiais atualmente.\r\n   * Usada para mostrar mensagem \"Você não possui filiais\".\r\n   */\r\n  existsFilials: boolean = true;\r\n\r\n  company: Company;\r\n\r\n  get isTEAM(): boolean {\r\n    return this.shared.isTeam\r\n  }\r\n\r\n  constructor(public navCtrl: NavController,\r\n    public authentication: AuthenticationService,\r\n    public menuCtrl: MenuController,\r\n    private ref: ChangeDetectorRef,\r\n    public loadingCtrl: LoadingController,\r\n    public shared: SharedService,\r\n    private route: ActivatedRoute,\r\n    public system: SystemService) { }\r\n\r\n  /**\r\n   * Inicializar a lista de relacionamentos.\r\n   * @todo Tirar dos comentarios\r\n   */\r\n  ngOnInit(): void {\r\n    this.menuCtrl.enable(true)\r\n    this.loading = true\r\n    this.existsFilials = true\r\n\r\n    this.initSubscription = this.route.paramMap\r\n      .pipe(switchMap((params: ParamMap) => {\r\n        if (params.get('company_id'))\r\n          return Company.object(params.get('company_id'))\r\n        else if (this.shared.isManager)\r\n          return this.shared.company$\r\n        else\r\n          return of(null)\r\n      }))\r\n      .pipe(first())\r\n      .pipe(switchMap((company: Company) => {\r\n        let filials$: Observable<Filial[]>\r\n        if (company) {\r\n          this.company = company;\r\n          console.log(this.company)\r\n          filials$ = Company.filials\r\n            .list(company.id)\r\n        } else {\r\n          filials$ = Filial.list()\r\n        }\r\n\r\n        return filials$\r\n      }))\r\n      .subscribe((filials: Filial[]) => {\r\n        this.filials = filials;\r\n        // Verificar se não existe categorias.\r\n        if (filials && filials.length === 0) {\r\n          this.existsFilials = false\r\n        } else {\r\n          this.existsFilials = true\r\n        }\r\n        // Não está mais carregando.\r\n        this.loading = false;\r\n        this.ref.detectChanges()\r\n      }, err => {\r\n        this.loading = false\r\n        this.ref.detectChanges()\r\n        this.system.showErrorAlert(err);\r\n      })\r\n  }\r\n\r\n  detect() {\r\n    this.ref.detectChanges()\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.initSubscription) this.initSubscription.unsubscribe()\r\n  }\r\n\r\n  /**\r\n   * Ir para página de adição\r\n   */\r\n  add() {\r\n    this.navCtrl.navigateRoot(['filial/edit', { company_id: this.company.id }])\r\n  }\r\n\r\n  /**\r\n   * Ir para a página FilialEditPage para editar uma filial\r\n   * @param filial filial a ser editada\r\n   */\r\n  async edit(filial: Filial) {\r\n    this.navCtrl.navigateRoot(['filial/edit', { company_id: filial.company.id, filial_id: filial.id }])\r\n  }\r\n\r\n  /**\r\n   * Abrir o estoque de uma determinada filial\r\n   * @param filial Filial escolhida\r\n   * @todo OPEN CARDAPIO\r\n   */\r\n  openStock(filial: Filial) {\r\n    this.navCtrl.navigateRoot(['stock/list', { filial_id: filial.id, company_id: filial.company.id }])\r\n  }\r\n\r\n  openStockPromotion(filial: Filial) {\r\n    this.navCtrl.navigateRoot(['stock/promotion/list', { filial_id: filial.id, company_id: filial.company.id }])\r\n  }\r\n\r\n  openInvoice(filial: Filial) {\r\n    this.navCtrl.navigateRoot(['invoice/list', { filial_id: filial.id, company_id: filial.company.id }])\r\n  }\r\n\r\n  openStatistics(filial: Filial) {\r\n    this.navCtrl.navigateRoot(['statistic/orders', { filial_id: filial.id, company_id: filial.company.id }])\r\n  }\r\n\r\n  changeActiveStatus(filial: Filial) {\r\n    Filial.changeActive(filial, filial.active).subscribe()\r\n  }\r\n\r\n}\r\n"],"sourceRoot":""}