{"version":3,"sources":["webpack:///./src/app/mobile/pages/evaluate-order/evaluate-order.module.ts","webpack:///./src/app/mobile/pages/evaluate-order/evaluate-order.page.html","webpack:///./src/app/mobile/pages/evaluate-order/evaluate-order.page.scss","webpack:///./src/app/mobile/pages/evaluate-order/evaluate-order.page.ts"],"names":[],"mappings":"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","file":"default~mobile-pages-customer-customer-module~mobile-pages-evaluate-order-evaluate-order-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { EvaluateOrderPage } from './evaluate-order.page';\r\nimport { GlobalComponentsModule } from '../../../components/global-components.module';\r\nimport { MobileComponentsModule } from '../../components/mobile-components.module';\r\nimport { PipesModule } from '../../../pipes/pipes.module';\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    //Custom Modules\r\n    GlobalComponentsModule,\r\n    MobileComponentsModule,\r\n    PipesModule,\r\n\r\n    //Default Modules\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n  ],\r\n  declarations: [EvaluateOrderPage],\r\n  entryComponents: [EvaluateOrderPage]\r\n})\r\nexport class EvaluateOrderPageModule { }\r\n","module.exports = \"<ion-header no-border class=\\\"app\\\">\\r\\n  <ion-toolbar color=\\\"primary\\\" hideBackButton=\\\"true\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-button (click)=\\\"dismiss()\\\">\\r\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"ios-arrow-back\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title class=\\\"title-default\\\">\\r\\n      <h3 ion-text class=\\\"my-font-logo\\\" no-margin>AVALIAÇÃO</h3>\\r\\n    </ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n\\r\\n<ion-content margin-top>\\r\\n\\r\\n  <mr-card-filial [order]=\\\"order\\\" [filial]=\\\"order.filial_full\\\" [phone]=\\\"true\\\"></mr-card-filial>\\r\\n\\r\\n  <ion-item class=\\\"shadow shadow-light  \\\">\\r\\n    <div class=\\\"satisfaction\\\">\\r\\n      <p text-center text-wrap>Você ficou satisfeito com esse pedido?</p>\\r\\n      <!-- <rating class=\\\"rating\\\" [(ngModel)]=\\\"rate\\\" (ngModelChange)=\\\"onModelChange($event)\\\"></rating> -->\\r\\n      <rating [quantity]=\\\"5\\\" [size]=\\\"'large'\\\" (changeStar)=\\\"changeStar($event)\\\"></rating>\\r\\n    </div>\\r\\n  </ion-item>\\r\\n\\r\\n  <div class=\\\"bg-white padding-left shadow shadow-light\\\">\\r\\n    <ion-item no-padding no-lines margin-top>\\r\\n      <div margin-left>\\r\\n        <p text-wrap>Deixe seu comentário</p>\\r\\n      </div>\\r\\n    </ion-item>\\r\\n\\r\\n    <ion-item no-padding style=\\\"margin-top: -1em\\\">\\r\\n      <ion-label></ion-label>\\r\\n      <ion-textarea [(ngModel)]=\\\"comment\\\" name=\\\"description\\\" rows=\\\"6\\\" placeholder=\\\"Escreva um elogio, crítica ou sugestão para o restaurante...\\\"></ion-textarea>\\r\\n    </ion-item>\\r\\n  </div>\\r\\n\\r\\n\\r\\n</ion-content>\\r\\n\\r\\n<ion-footer>\\r\\n  <ion-button expand=\\\"block\\\" size=\\\"large\\\" color=\\\"primary\\\" class=\\\"button-bottom my-font-logo\\\" [disabled]=\\\"!rate\\\" (click)=\\\"finishOrder()\\\">\\r\\n    ENVIAR AVALIAÇÃO\\r\\n  </ion-button>\\r\\n</ion-footer>\"","module.exports = \"ion-item {\\n  background: white !important;\\n  --background: white !important; }\\n  ion-item p {\\n    font-size: 1.1em !important;\\n    color: var(--ion-color-medium) !important; }\\n  .button-bottom {\\n  margin: 0 !important; }\\n  textarea {\\n  background-color: white !important; }\\n  div.satisfaction {\\n  padding-left: 10px !important; }\\n  .bg-white {\\n  background: white !important; }\\n  .padding-left {\\n  padding-left: 10px !important; }\\n\"","import { Component, OnInit } from '@angular/core';\r\nimport { Order } from '../../../../models/order';\r\nimport { ToastController, NavController, NavParams, LoadingController, AlertController, ModalController } from '@ionic/angular';\r\nimport { SystemService } from '../../../services/system.service';\r\nimport { firestore } from \"firebase\";\r\n\r\nimport \"firebase/firestore\"\r\n\r\n@Component({\r\n  selector: 'app-evaluate-order',\r\n  templateUrl: './evaluate-order.page.html',\r\n  styleUrls: ['./evaluate-order.page.scss'],\r\n})\r\nexport class EvaluateOrderPage {\r\n\r\n  order: Order;\r\n\r\n  rate: number;\r\n\r\n  comment: string;\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, public loadingCtrl: LoadingController,\r\n    public system: SystemService, public alertCtrl: AlertController, public modalCtrl: ModalController, public toastCtrl: ToastController) {\r\n\r\n    this.order = this.navParams.get('order');\r\n\r\n  }\r\n\r\n  ionViewDidEnter(): void {\r\n    this.system.setScreenName(\"EvaluateOrderPage\")\r\n  }\r\n\r\n  changeStar(ev) {\r\n    this.rate = ev;\r\n  }\r\n\r\n  dismiss() {\r\n    this.modalCtrl.dismiss();\r\n  }\r\n\r\n  async finishOrder() {\r\n    let loading = await this.loadingCtrl.create({})\r\n    loading.present()\r\n    if (!this.rate && !this.comment) {\r\n      loading.dismiss()\r\n      this.dismiss();\r\n    }\r\n    else {\r\n      let objOrder: Order = {};\r\n      objOrder.evaluate = {\r\n        created_at: firestore.Timestamp.fromDate(new Date())\r\n      };\r\n\r\n      //Se houver comentário\r\n      if (this.comment && this.comment.trim().length > 0) {\r\n        objOrder.evaluate.comment = this.comment;\r\n      }\r\n      if (this.rate) {\r\n        objOrder.evaluate.rate = this.rate;\r\n      }\r\n\r\n      //Deve-se atualizar Order (registrar a avaliação do usuário) e Filial (calcular nova média de satisfação)\r\n      if (this.rate) {\r\n\r\n        objOrder.evaluate.rate = this.rate;\r\n\r\n        Order.update(this.order.id, objOrder).subscribe(async () => {\r\n          let toast = await this.toastCtrl.create({\r\n            message: `Sua avaliação foi enviada com sucesso!`,\r\n            position: 'bottom',\r\n            duration: 1500\r\n          });\r\n          toast.present()\r\n          loading.dismiss()\r\n          this.modalCtrl.dismiss();\r\n        }, error => {\r\n          this.system.showErrorAlert(error);\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  async help() {\r\n    let alert = await this.alertCtrl.create({\r\n      message: 'Avalie e caso queira, deixe uma mensagem para ajudar o restaurante a melhorar seus servições. Apenas o restaurante poderá ver sua avaliação!',\r\n      buttons: ['Ok']\r\n    })\r\n    alert.present()\r\n  }\r\n\r\n  onModelChange(currentRate) {\r\n    //@todo Realizar avaliações mais elaboradas no futuro se nota menor q 5 estrelas\r\n  }\r\n\r\n}"],"sourceRoot":""}