{"version":3,"sources":["webpack:///./src/app/mobile/pages/login-app/login-app.module.ts","webpack:///./src/app/mobile/pages/login-app/login-app.page.html","webpack:///./src/app/mobile/pages/login-app/login-app.page.scss","webpack:///./src/app/mobile/pages/login-app/login-app.page.ts"],"names":[],"mappings":"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","file":"default~mobile-pages-customer-address-customer-address-module~mobile-pages-customer-customer-module~~bd0e9492.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n// import { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule, IonApp } from '@ionic/angular';\r\n\r\nimport { LoginAppPage } from './login-app.page';\r\nimport { GlobalComponentsModule } from '../../../components/global-components.module';\r\nimport { PipesModule } from '../../../pipes/pipes.module';\r\n\r\n// const routes: Routes = [\r\n//   {\r\n//     path: '',\r\n//     component: LoginAppPage\r\n//   }\r\n// ];\r\n\r\n@NgModule({\r\n  imports: [\r\n    //Custom Modules\r\n    GlobalComponentsModule,\r\n    PipesModule,\r\n\r\n    //Default Modules\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    // RouterModule.forChild(routes)\r\n  ],\r\n  entryComponents: [LoginAppPage],\r\n  declarations: [LoginAppPage],\r\n  providers: [IonApp]\r\n})\r\nexport class LoginAppPageModule {}\r\n","module.exports = \"<ion-header no-border class=\\\"app\\\">\\r\\n  <ion-toolbar color=\\\"primary\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-button size=\\\"small\\\" (click)=\\\"back()\\\">\\r\\n        <ion-icon class=\\\"arrow-back\\\" slot=\\\"icon-only\\\" name=\\\"ios-arrow-back\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title class=\\\"title-default\\\">\\r\\n      <h3 ion-text class=\\\"my-font-logo\\\" no-margin>LOGIN</h3>\\r\\n    </ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content class=\\\"hideScrollbar\\\" no-margin no-padding>\\r\\n\\r\\n  <header>\\r\\n    <nano-thumb [kind]=\\\"'person'\\\" [large2x]=\\\"true\\\" [round]=\\\"true\\\" [border]=\\\"true\\\"></nano-thumb>\\r\\n  </header>\\r\\n\\r\\n  <!-- <section>\\r\\n    <ion-list no-lines [hidden]=\\\"!loading\\\">\\r\\n      <ion-item text-center color=\\\"transparent\\\">\\r\\n        <ion-spinner color=\\\"light\\\"></ion-spinner>\\r\\n      </ion-item>\\r\\n    </ion-list>\\r\\n  </section> -->\\r\\n\\r\\n  <!-- Container dos botões de login -->\\r\\n  <footer>\\r\\n    <p class=\\\"text-buttons\\\" margin-bottom>Escolha como quer acessar</p>\\r\\n    <!-- <ion-button shape=\\\"block\\\" (click)=\\\"doLogin('facebook')\\\" icon-left color=\\\"facebook\\\" text-uppercase style=\\\"margin-bottom: 1em!important\\\">\\r\\n      <ion-icon name=\\\"logo-facebook\\\"></ion-icon>\\r\\n      Entrar com Facebook\\r\\n    </ion-button> -->\\r\\n    <ion-button shape=\\\"block\\\" icon-left (click)=\\\"doLogin('google')\\\" color=\\\"gmail\\\" text-uppercase>\\r\\n      <ion-icon name=\\\"logo-googleplus\\\"></ion-icon>\\r\\n      Entrar com Gmail\\r\\n    </ion-button>\\r\\n  </footer>\\r\\n\\r\\n</ion-content>\"","module.exports = \"ion-header ion-title {\\n  font-family: myFontBold !important; }\\n\\nion-header ion-icon {\\n  font-size: 1.5rem;\\n  margin: 0px 5px; }\\n\\n.scroll-content {\\n  display: flex;\\n  flex-flow: column; }\\n\\n.background-cover {\\n  background-color: rgba(0, 0, 0, 0.65);\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n  z-index: -1 !important; }\\n\\n.logo-maisrangos {\\n  z-index: 2 !important;\\n  width: 120% !important;\\n  margin-left: -10% !important;\\n  max-width: 400% !important;\\n  height: auto !important; }\\n\\nheader nano-thumb {\\n  display: flex;\\n  justify-content: center;\\n  align-content: center;\\n  align-items: center;\\n  padding-top: 30%; }\\n\\nsection {\\n  flex: 1 1 auto; }\\n\\nfooter {\\n  flex: 0 1 40px;\\n  margin-bottom: 40% !important;\\n  font-family: 'Roboto', sans-serif !important;\\n  width: 80%;\\n  margin-left: 10%; }\\n\\nfooter button {\\n    border-radius: 5px !important;\\n    text-align: center; }\\n\\nfooter button ion-icon {\\n      margin-top: -4px; }\\n\\n.text-buttons {\\n  color: black;\\n  text-align: center;\\n  font-size: 1.15em; }\\n\"","import { Component, OnInit } from '@angular/core';\r\nimport { NavController, IonApp, LoadingController, MenuController, ModalController } from '@ionic/angular';\r\nimport { AuthenticationService } from '../../../services/authentication.service';\r\nimport { PlacesService } from '../../../services/places.service';\r\nimport { SystemService } from '../../../services/system.service';\r\nimport { Observable, Subscription, of, from, combineLatest } from 'rxjs';\r\nimport { map, tap, flatMap, first, catchError, switchMap } from 'rxjs/operators';\r\nimport { User, Permission } from '../../../../models/user';\r\nimport { Location } from '../../../../models/utils/location';\r\nimport { cleanObject } from '../../../util/util';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { ShoppingCartPage } from '../shopping-cart/shopping-cart.page';\r\nimport { CustomerPage } from '../customer/customer.page';\r\n\r\n@Component({\r\n  selector: 'app-login-app',\r\n  templateUrl: './login-app.page.html',\r\n  styleUrls: ['./login-app.page.scss'],\r\n})\r\nexport class LoginAppPage {\r\n\r\n  page: string;\r\n  pageBefore: string;\r\n\r\n  constructor(public nav: NavController,\r\n    public authProvider: AuthenticationService,\r\n    public app: IonApp,\r\n    private loadingCtrl: LoadingController,\r\n    private menuCtrl: MenuController,\r\n    private placesProvider: PlacesService,\r\n    private system: SystemService,\r\n    public modalCtrl: ModalController,\r\n    private route: ActivatedRoute) {\r\n\r\n    this.menuCtrl.enable(false);\r\n\r\n    // this.page = this.navParams.get('page');\r\n    this.route.paramMap.subscribe((params: ParamMap) => {\r\n      this.page = params.get('page');\r\n      this.pageBefore = params.get('pageBefore');\r\n    })\r\n  }\r\n\r\n  ionViewDidEnter(): void {\r\n    this.system.setScreenName(\"LoginAppPage\");\r\n  }\r\n\r\n  back() {\r\n    this.modalCtrl.dismiss();\r\n    // this.nav.goBack();\r\n  }\r\n\r\n  async doLogin(method: \"google\" | \"facebook\") {\r\n    let loading = await this.loadingCtrl.create({});\r\n    loading.present();\r\n\r\n    let method$: Observable<firebase.User>\r\n    if (method === \"google\") {\r\n      method$ = this.authProvider.signInGoogle()\r\n    } else if (method === \"facebook\") {\r\n      method$ = this.authProvider.signInFacebook()\r\n    }\r\n    method$.pipe(first())\r\n      .pipe(flatMap((data: any) => {\r\n        console.log('Dados recebidos do login: ', data);\r\n        var user: User\r\n        if (data.email) {\r\n          user = {\r\n            name: data.displayName as string,\r\n            email: data.email as string,\r\n            image: data.photoURL as string,\r\n            phone_social: data.phoneNumber as string,\r\n            permissions: [Permission.CUSTOMER]\r\n          };\r\n        }\r\n        else if (data.user) {\r\n          user = {\r\n            name: data.user.displayName as string,\r\n            email: data.user.email as string,\r\n            image: data.user.photoURL as string,\r\n            phone_social: data.user.phoneNumber as string,\r\n            permissions: [Permission.CUSTOMER]\r\n          };\r\n        }\r\n\r\n        console.log('User: ', user);\r\n        //Excluir atributos undefined\r\n        user = cleanObject(user);\r\n        console.log('Clean USER: ', user);\r\n\r\n        let uid = data.uid ? data.uid : data.user.uid;\r\n\r\n        return User.object(uid).pipe(first()).pipe(flatMap((userDatabase: any) => {\r\n          //Usuário já tem localização definida\r\n          if (userDatabase && userDatabase.location) {\r\n            return User.update(uid, user)\r\n          }\r\n          //Usuário ainda não tem localização definida\r\n          else {\r\n            //Atribuir ao endereço principal o último endereço adicionado no histórico\r\n            if (user.locations_history && user.locations_history.length > 0) {\r\n              user.location = user.locations_history[user.locations_history.length - 1];\r\n              return User.update(uid, user)\r\n            }\r\n            //Obter pelo GPS\r\n            else {\r\n              return this.placesProvider.getCurrentLocation().pipe(first()).pipe(flatMap((locationUser: Location) => {\r\n                locationUser.isGps = true;\r\n                user.location = locationUser;\r\n                user.physical_location = user.location;\r\n                return User.update(uid, user)\r\n              }))\r\n                .pipe(catchError(() => {\r\n                  console.log('algo deu errado na localizacao: ', user);\r\n                  // ALgo deu errado ao conseguir a localização do usuário\r\n                  return User.update(uid, user)\r\n                }))\r\n            }\r\n          }\r\n\r\n        }))\r\n      })).subscribe(async () => {\r\n        // this.app.getRootNav().setRoot(this.shared.rootPage)\r\n        // this.modalCtrl.dismiss().then(() => {\r\n        //   if (this.page) this.nav.push(this.page);\r\n        // })\r\n        // this.nav.goBack();\r\n        this.modalCtrl.dismiss();\r\n\r\n        if (this.page == 'CustomerPage') {\r\n          // const modal = await this.modalCtrl.create({\r\n          //   component: CustomerPage\r\n          // });\r\n          // modal.present();\r\n          this.nav.navigateRoot(['mobile/customer-details', {\r\n            pageBefore: this.pageBefore\r\n          }])\r\n        }\r\n        else if (this.page == 'ShoppingCartPage') {\r\n          this.nav.navigateRoot('mobile/cart')\r\n        }\r\n        else if (this.page == 'PromotionDetailPage') {\r\n          this.modalCtrl.dismiss();\r\n        }\r\n        loading.dismiss()\r\n        this.system.logEvent(`login_success_${method}`)\r\n      }, error => {\r\n        console.log('Deu errado auth: ', error)\r\n        loading.dismiss()\r\n        this.system.showErrorAlert(error, `Autenticação pelo ${method}`, true);\r\n      });\r\n  }\r\n\r\n}"],"sourceRoot":""}